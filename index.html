<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0040)http://sei.pku.edu.cn/~zhumy12/innertest -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
    <title>InnerTest</title>
<style id="clearly_highlighting_css" type="text/css">/* selection */ html.clearly_highlighting_enabled ::-moz-selection { background: rgba(246, 238, 150, 0.99); } html.clearly_highlighting_enabled ::selection { background: rgba(246, 238, 150, 0.99); } /* cursor */ html.clearly_highlighting_enabled {    /* cursor and hot-spot position -- requires a default cursor, after the URL one */    cursor: url("chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/images/highlight--cursor.png") 14 16, text; } /* highlight tag */ em.clearly_highlight_element {    font-style: inherit !important; font-weight: inherit !important;    background-image: url("chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/images/highlight--yellow.png");    background-repeat: repeat-x; background-position: top left; background-size: 100% 100%; } /* the delete-buttons are positioned relative to this */ em.clearly_highlight_element.clearly_highlight_first { position: relative; } /* delete buttons */ em.clearly_highlight_element a.clearly_highlight_delete_element {    display: none; cursor: pointer;    padding: 0; margin: 0; line-height: 0;    position: absolute; width: 34px; height: 34px; left: -17px; top: -17px;    background-image: url("chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/images/highlight--delete-sprite.png"); background-repeat: no-repeat; background-position: 0px 0px; } em.clearly_highlight_element a.clearly_highlight_delete_element:hover { background-position: -34px 0px; } /* retina */ @media (min--moz-device-pixel-ratio: 2), (-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2) {    em.clearly_highlight_element { background-image: url("chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/images/highlight--yellow@2x.png"); }    em.clearly_highlight_element a.clearly_highlight_delete_element { background-image: url("chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/images/highlight--delete-sprite@2x.png"); background-size: 68px 34px; } } </style><style type="text/css"></style><style>[touch-action="none"]{ -ms-touch-action: none; touch-action: none; }[touch-action="pan-x"]{ -ms-touch-action: pan-x; touch-action: pan-x; }[touch-action="pan-y"]{ -ms-touch-action: pan-y; touch-action: pan-y; }[touch-action="scroll"],[touch-action="pan-x pan-y"],[touch-action="pan-y pan-x"]{ -ms-touch-action: pan-x pan-y; touch-action: pan-x pan-y; }</style></head>

<body ryt13120="1">
    <h1>InnerTest: A Unit Testing Tool Supporting Input-Specific Assertions on Internal States</h1>
	
	<ul>
	<li><a href="http://sei.pku.edu.cn/~zhumy12/innertest#introduction">Introduction</a></li>
	<li><a href="http://sei.pku.edu.cn/~zhumy12/innertest#people">People</a></li>
	<li><a href="http://sei.pku.edu.cn/~zhumy12/innertest#download">Download</a></li>
	<li><a href="http://sei.pku.edu.cn/~zhumy12/innertest#guide">Guide</a></li>
	<li><a href="http://sei.pku.edu.cn/~zhumy12/innertest#contact">Contact</a></li>
	</ul><style id="q22jtv8" class="x1tayrr q22jtv8">
	.t1d4vvc {
		width:420px;
		height:420px;
		border-radius:2px;
		box-shadow:0 0 7px rgba(0,0,0,0.4);
		background:#fff;
		position:fixed;
		left:50%;
		top:50%;
		margin-left:-210px;
		margin-top:-210px;
		z-index:2147483646;
		display:none;
		font:14px/1.5 arial,\5b8b\4f53,sans-serif;
	}
	.xfuwms {
		height:52px;
		border-bottom:solid 1px #e4e4e4;
		padding:20px;
		font-size:20px;
		font-weight:400;
		position:relative;
	}
	.xfuwms img {
		float:left;
		margin-right:15px;	
	}
	
	.v18ehs1 {height:227px;font-size:14px;padding:20px;}
	.v18ehs1 .gmqur9 {
		float:left;
		margin-right:20px;
		margin-top:-6px;
	}
	
	.v18ehs1 .tcl0li {
		margin-top:10px;
		margin-bottom:25px;
	}
	.v18ehs1 span {color:red;}
	
	.b24bqlj {
		background-color:#e9e9e9;
		height:20px;
		padding:20px;
		border-bottom-right-radius:2px;
		border-bottom-left-radius:2px;
	}
	
	.b24bqlj label {
		background:url(chrome-extension://keigpnkjljkelclbjbekcfnaomfodamj/assets/images/qrcode/check.png)no-repeat 0 1px;
	}
	
	.b24bqlj label.selected {
		background:url(chrome-extension://keigpnkjljkelclbjbekcfnaomfodamj/assets/images/qrcode/checked.png)no-repeat 0 0;
	}
	
	.b24bqlj label input {
		opacity:0;
		margin-right:10px;
	}
	
	.xfuwms .c1k790f {
		position:absolute;
		right:10px;
		top:5px;
		font-size:24px;
		text-decoration:none;
		color:#b3b3b3;
	}
	.xfuwms a {
		color:#377bee;
	}
</style>


	<div class="t1d4vvc">		
			<div class="xfuwms"><img src="chrome-extension://keigpnkjljkelclbjbekcfnaomfodamj/assets/images/qrcode/icon.png">已成功收藏到<a href="http://ruyi.taobao.com/my/want">一淘收藏夹</a><br>从手机一淘收藏夹购买更优惠<a class="c1k790f" href="http://sei.pku.edu.cn/~zhumy12/innertest#">×</a></div>
			<div class="v18ehs1">
				<img class="gmqur9" src="chrome-extension://keigpnkjljkelclbjbekcfnaomfodamj/assets/images/qrcode/msg.png">
				扫码安装一淘客户端
				<div class="tcl0li"><img src="chrome-extension://keigpnkjljkelclbjbekcfnaomfodamj/assets/images/qrcode/etaoqr.png" width="116" height="116"></div>
				安卓手机扫码初装，<br> 登录后送<span>50</span>个集分宝
			</div>
			<div class="b24bqlj"><label><input id="no-tips" type="checkbox">不再提示</label></div>
	</div>
	



	<h2 id="introduction">Introduction</h2>
	<p>InnerTest is a tool that supporting input-specific assertion on internal states.</p>
	<p>An important factor of the fault-detection capability of a test
  suite is how well the test oracles catch a triggered
  fault. Traditional test oracles are defined on the outputs of test
  executions. Recently, researchers have shown theoretically that test
  oracles defined on the internal states of execution could improve
  the fault-detection capability. However, in practice, we can only
  write assertions that are common to all test inputs, and there is no
  supporting mechanism for the testers to write input-specific
  assertions on internal states.</p>
  <!-- <p>A demonstration video will be accessed at: <a href="http://youtu.be/23d8yPCwpKs">http://youtu.be/23d8yPCwpKs</a></p> -->
  
  <h2 id="people">People</h2>
	<table>
				
		<tbody><tr><td><a href="http://sei.pku.edu.cn/~zhumy12/">Muyao Zhu</a></td><td>Master Student at Peking University</td>
		</tr><tr><td>Tao Zhu</td><td>Master Student at Peking University</td></tr>
		<tr><td><a href="http://sei.pku.edu.cn/~xiongyf04">Yingfei Xiong</a></td><td>Assistant Professor at Peking University</td></tr>
		<tr><td><a href="http://www.sei.pku.edu.cn/~haod">Dan Hao</a></td><td>Associate Professor at Peking University</td></tr>
		<tr><td><a href="http://sei.pku.edu.cn/~zhanglu/">Lu Zhang</a></td><td>Professor at Peking University</td></tr>

	</tbody></table>
  <h2 id="download">Download</h2>
  <p>InnerTest is implemented as a Java library, you can download the library .jar file here <a href="http://sei.pku.edu.cn/~zhumy12/InnerTest_Files/InnerTest.jar">Download</a></p>

  <h2 id="guide">A Guide to the Samples</h2>
  
  <img src="./InnerTest_files/1.PNG" alt="Sample Code"><br>
  <p>Figure 1: Sample Source Code &amp; Test Code</p>
  <p>We take source code and test code in Figure 1&amp;2 for example. The code calculates whether the number of positives is bigger than negatives or not. But there is a bug in the source code. The element "0" will be treated as negative.</p>
 
  <p>But test with input <i>int[] input = new int[]{-2, -1, 0, 1, 2, 3, 4}</i> cannot find the error, the return value still be 1. (The number of negatives was calculated as 3, which should be 2. But the number of positives of 4, 4 is bigger than 3 and 2.)</p>
  <p>Then we use InnerTest to write input-specific assertion on internal state to find this error. First we should import our library into your build path. Besides our tool, you need also make sure that tools.jar from your Java SDK should be imported into your build path.</p><style type="text/css" id="v19fzdo" class="x1tayrr">
	.db72v5 {
			border-radius:2px;
			box-shadow:0 0 7px rgba(0,0,0,0.4);
			position:absolute;
			top:376px;
			left:404px;
			margin-bottom:100px;
			background:#fff;
			z-index:2147483646;
			display:none;
			font:14px/1.5 arial,\5b8b\4f53,sans-serif;
	}
	
	.db72v5 .jyxyg {}

    .db72v5 .m76rij {
        background:#fff;
        position:absolute;
        height:8px;
		width:8px;
        margin-left:-3px;
        -webkit-transform:rotate(45deg);
		transform:rotate(45deg);
		left:20%;
    }
	
	.db72v5.s3unvb .m76rij {
		box-shadow : -1px -1px 2px rgba(0, 0, 0,0.4);
        top:-5px;    
	}
	
	.db72v5.akfu4z .m76rij {
        bottom:-5px;
		box-shadow : 1px 1px 2px rgba(0, 0, 0,0.4);
	}
	
	.db72v5.womdsu .m76rij{
		left:50%;
	}
	
	.c1k790f {
		font-style:normal;
		font-size:23px;
		position:relative;
		top:3px;
	}
	
	.v1t407k {
		width:170px;
		padding:20px;
		font-size:14px;
	}
	
	.v1t407k .ya4mvf {
		text-decoration:none;
		font-size:14px;
		color:#999;
		float:right;	
		position:relative;
		top:5px;
	}
	
	.jyxyg {
		overflow:hidden;
	}
	
	.ya4mvf:hover {
		color:#1e90ff;
	}
	
	.i17v5s2 {
			width:120px;
			height:152px;
			padding:20px;
    }
	.i17v5s2 .f6yfu6 {
			 margin-bottom:10px;
    }
	
	.i17v5s2 .jyxyg span{
		color:red;
	}
</style>

<div class="db72v5 s3unvb v1t407k">
		<div class="m76rij"></div>
		<div class="jyxyg">
		同步商品到手机一淘收藏夹， 手机购买更优惠！
		<a class="ya4mvf" href="http://sei.pku.edu.cn/~zhumy12/innertest#">我知道了<i class="c1k790f">×</i></a>
	</div>
</div>

<div class="db72v5 akfu4z womdsu i17v5s2">
		<div class="m76rij"></div>
		<div class="jyxyg">
			<div class="f6yfu6"></div>
			<div class="p13b6eq">手机购买省<span>13</span>元</div>
		</div>
</div>

  <p>We provide several kinds of interfaces for testers to locate the code to be checked, here we use the one that first add a marker inside the code to locate where to check: <b>Controller.addCheck(String locationKey, int times, Object input, Object expectedValue, String expression)</b> It has 5 parameters.</p>
  <p>The first one is the marker identifier, which we defined in source ocde, to locate the code where we want to check or test</p>
  <p>The second parameter is execution times, it defines at which time executing here, we check the expression and value. The reason that we import this parameter into interface is that, a statement may be executed several times in one test, and specifying only the location does not distinguish different executions.</p>
	<p>The third one is class object, to specifies the Java file that we should instrument. We use the class name to locate a file name because the source file name is not available in Java byte code.</p>
	<p>The last two are theexpression to be checked and the expected value, in this example, theyshould be integer value 2 and variable negative, means checking whether <i>negative == 2</i> or not.
Last but not lease, you should invoke a clean method <b>Controller.clean()</b>. To ensure that the assertion is only effective during the execution of the test. This clean up is necessary because there may be dependencies between tests. When there are dependencies, we cannot start a new process for each test execution, but has to execute one test after another in one process. See Fig 3 belo.</p>
	<img src="./InnerTest_files/4_commented.png" alt="Write InnerTest oracle"><br>
<p>Figure 3: Write Internal oracle </p>

<p>Before you run your InnerTest test, you should configure the JVM arguments in Run Configuration. Right click the test code, Go to <b>Run As -&gt; Run Configurations -&gt; Arguments -&gt; VM arguments</b>, add one line arguments <i>"-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=8000"</i>, this means you allow <a href="http://docs.oracle.com/javase/7/docs/technotes/tools/windows/jdb.html">jdb</a> to modify your class file</p>
	<img src="./InnerTest_files/5.PNG" alt="run configuration">
	<p>Figure 4: Run Configuration</p>
	<p>After that, you can run you InnerTest test now. Fig 5 below shows the result of the InnerTest, the result says that the variable negative should be "2", but actually it's "3".</p>
	<img src="./InnerTest_files/7.PNG" alt="Test result">
	<p>Figure 5: Test Result</p>

<h2 id="contact">Contact</h2>
<p>Please contact <b>"zhumuyao@gmail.com"</b> if you had any questions about InnerTest</p>


</body></html>