<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
    <title>InnerTest</title>
<style id="clearly_highlighting_css" type="text/css">/* selection */ html.clearly_highlighting_enabled ::-moz-selection { background: rgba(246, 238, 150, 0.99); } html.clearly_highlighting_enabled ::selection { background: rgba(246, 238, 150, 0.99); } /* cursor */ html.clearly_highlighting_enabled {    /* cursor and hot-spot position -- requires a default cursor, after the URL one */    cursor: url("chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/images/highlight--cursor.png") 14 16, text; } /* highlight tag */ em.clearly_highlight_element {    font-style: inherit !important; font-weight: inherit !important;    background-image: url("chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/images/highlight--yellow.png");    background-repeat: repeat-x; background-position: top left; background-size: 100% 100%; } /* the delete-buttons are positioned relative to this */ em.clearly_highlight_element.clearly_highlight_first { position: relative; } /* delete buttons */ em.clearly_highlight_element a.clearly_highlight_delete_element {    display: none; cursor: pointer;    padding: 0; margin: 0; line-height: 0;    position: absolute; width: 34px; height: 34px; left: -17px; top: -17px;    background-image: url("chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/images/highlight--delete-sprite.png"); background-repeat: no-repeat; background-position: 0px 0px; } em.clearly_highlight_element a.clearly_highlight_delete_element:hover { background-position: -34px 0px; } /* retina */ @media (min--moz-device-pixel-ratio: 2), (-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2) {    em.clearly_highlight_element { background-image: url("chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/images/highlight--yellow@2x.png"); }    em.clearly_highlight_element a.clearly_highlight_delete_element { background-image: url("chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/images/highlight--delete-sprite@2x.png"); background-size: 68px 34px; } } </style><style>[touch-action="none"]{ -ms-touch-action: none; touch-action: none; }[touch-action="pan-x"]{ -ms-touch-action: pan-x; touch-action: pan-x; }[touch-action="pan-y"]{ -ms-touch-action: pan-y; touch-action: pan-y; }[touch-action="scroll"],[touch-action="pan-x pan-y"],[touch-action="pan-y pan-x"]{ -ms-touch-action: pan-x pan-y; touch-action: pan-x pan-y; }</style><style type="text/css"></style></head>

<body>
    <h1>InnerTest: A Unit Testing Tool Supporting Input-Specific Assertions on Internal States</h1>
	
	<ul>
	<li><a href="#introduction">Introduction</a></li>
	<li><a href="#people">People</a></li>
	<li><a href="#download">Download</a></li>
	<li><a href="#guide">Guide</a></li>
	<li><a href="#contact">Contact</a></li>
	</ul>

	<h2 id="introduction">Introduction</h2>
	<a href="https://github.com/ayzk/detailcheck/">Download Source code and Jar in Github.com</a>
	<p>InnerTest is a tool that supporting input-specific assertion on internal states.</p>
	<p>An important factor of the fault-detection capability of a test
  suite is how well the test oracles catch a triggered
  fault. Traditional test oracles are defined on the outputs of test
  executions. Recently, researchers have shown theoretically that test
  oracles defined on the internal states of execution could improve
  the fault-detection capability. However, in practice, we can only
  write assertions that are common to all test inputs, and there is no
  supporting mechanism for the testers to write input-specific
  assertions on internal states.</p>
  <p>A demonstration video will be accessed at: <a href="http://youtu.be/23d8yPCwpKs">http://youtu.be/23d8yPCwpKs</a></p>
  
  <h2 id="people">People</h2>
	<table> ã€€
		<tr><td><a href="http://cn.linkedin.com/pub/kai-zhao/51/36/b51/">Zhao Kai</a></td><td>Undergraduate Student at Peking University</td></tr>		
		<tr><td><a href="http://sei.pku.edu.cn/~zhumy12/">Muyao Zhu</a></td><td>Master Student at Peking University</td></tr>
		<tr><td>Tao Zhu</td><td>Master Student at Peking University</td></tr>
		<tr><td><a href="http://sei.pku.edu.cn/~xiongyf04">Yingfei Xiong</a></td><td>Assistant Professor at Peking University</td></tr>
		<tr><td><a href="http://www.sei.pku.edu.cn/~haod">Dan Hao</a></td><td>Associate Professor at Peking University</td></tr>
		<tr><td><a href="http://sei.pku.edu.cn/~zhanglu/">Lu Zhang</a></td><td>Professor at Peking University</td></tr>

	</table>
  <h2 id="guide">A Guide to the Samples</h2>
  
  <img src="images/1.PNG" alt="Sample Code"><br>
  <p>Figure 1: Sample Source Code &amp; Test Code</p>
  <p>We take source code and test code in Figure 1&amp;2 for example. The code calculates whether the number of positives is bigger than negatives or not. But there is a bug in the source code. The element "0" will be treated as negative.</p>
 
  <p>But test with input <i>int[] input = new int[]{-2, -1, 0, 1, 2, 3, 4}</i> cannot find the error, the return value still be 1. (The number of negatives was calculated as 3, which should be 2. But the number of positives of 4, 4 is bigger than 3 and 2.)</p>
  <p>Then we use InnerTest to write input-specific assertion on internal state to find this error. First we should import our library into your build path. Besides our tool, you need also make sure that tools.jar from your Java SDK should be imported into your build path.</p>
    <p>We provide several kinds of interfaces for testers to locate the code to be checked, here we use the one that first add a marker inside the code to locate where to check: <b>Controller.addCheck(String locationKey, int times, Object input, Object expectedValue, String expression)</b> It has 5 parameters.</p>
  <p>The first one is the marker identifier, which we defined in source ocde, to locate the code where we want to check or test</p>
  <p>The second parameter is execution times, it defines at which time executing here, we check the expression and value. The reason that we import this parameter into interface is that, a statement may be executed several times in one test, and specifying only the location does not distinguish different executions.</p>
	<p>The third one is class object, to specifies the Java file that we should instrument. We use the class name to locate a file name because the source file name is not available in Java byte code.</p>
	<p>The last two are theexpression to be checked and the expected value, in this example, theyshould be integer value 2 and variable negative, means checking whether <i>negative == 2</i> or not.
Last but not lease, you should invoke a clean method <b>Controller.clean()</b>. To ensure that the assertion is only effective during the execution of the test. This clean up is necessary because there may be dependencies between tests. When there are dependencies, we cannot start a new process for each test execution, but has to execute one test after another in one process. See Fig 3 belo.</p>
	<img src="images/4_commented.png" alt="Write InnerTest oracle"><br>
<p>Figure 3: Write Internal oracle </p>

<p>Before you run your InnerTest test, you should configure the JVM arguments in Run Configuration. Right click the test code, Go to <b>Run As -&gt; Run Configurations -&gt; Arguments -&gt; VM arguments</b>, add one line arguments <i>"-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=8000"</i>, this means you allow <a href="http://docs.oracle.com/javase/7/docs/technotes/tools/windows/jdb.html">jdb</a> to modify your class file</p>
	<img src="images/5.PNG" alt="run configuration">
	<p>Figure 4: Run Configuration</p>
	<p>After that, you can run you InnerTest test now. Fig 5 below shows the result of the InnerTest, the result says that the variable negative should be "2", but actually it's "3".</p>
	<img src="images/7.PNG" alt="Test result">
	<p>Figure 5: Test Result</p>

<h2 id="contact">Contact</h2>
<p>Please contact <b>"ayzk@pku.edu.cn"</b> if you had any questions about InnerTest</p>


</body></html>